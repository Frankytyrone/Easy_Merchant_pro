<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Builders Merchant Pro</title>
    <meta name="application-name" content="Easy Builders Merchant Pro">
    <meta name="theme-color" content="#1a3a5c">
    <link rel="canonical" href="https://shanemcgee.biz/ebmpro/">
    <link rel="manifest" href="/ebmpro/manifest.json">
    <link rel="stylesheet" href="/ebmpro/css/styles.css">
</head>
<body>
    <div id="app" class="app">
        <header class="header">
            <div class="header-left">
                <h1>üìã EBMP</h1>
            </div>
            <div class="header-center">
                <div class="store-selector">
                    <label>STORE:</label>
                    <select id="storeSelect" onchange="switchStore(this.value)">
                        <option value="falcarragh">Falcarragh</option>
                        <option value="gweedore">Gweedore</option>
                    </select>
                </div>
            </div>
            <div class="header-right">
                <button class="btn-icon" onclick="toggleMenu()" title="Menu">‚ãÆ</button>
            </div>
        </header>

        <main class="main-content">
            <section id="invoiceScreen" class="screen active">
                <div class="screen-title">New Invoice</div>
                
                <div class="form-group">
                    <label>Customer</label>
                    <input type="text" id="customerSearch" placeholder="Search customer..." autocomplete="off" autofocus>
                    <div id="customerList" class="dropdown-list"></div>
                    <button class="btn-secondary" onclick="showAddCustomer()">+ New Customer</button>
                </div>

                <div class="form-group">
                    <label>Search Products</label>
                    <input type="text" id="productSearch" placeholder="Search by code/description..." autocomplete="off">
                    <div id="productList" class="dropdown-list"></div>
                </div>

                <table class="invoice-table" id="invoiceItemsTable">
                    <thead>
                        <tr>
                            <th>Code</th>
                            <th>Description</th>
                            <th>Qty</th>
                            <th>Price</th>
                            <th>VAT%</th>
                            <th>Total</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="itemsBody">
                        <tr class="empty-row"><td colspan="7" style="text-align:center;color:#999;">No items added yet</td></tr>
                    </tbody>
                </table>

                <div class="invoice-totals">
                    <div class="total-row">
                        <span>Subtotal</span>
                        <span id="subtotal">‚Ç¨0.00</span>
                    </div>
                    <div class="total-row">
                        <span>VAT</span>
                        <span id="vat">‚Ç¨0.00</span>
                    </div>
                    <div class="total-row total-large">
                        <span>TOTAL</span>
                        <span id="total">‚Ç¨0.00</span>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="saveInvoice()">üíæ Save Invoice</button>
                    <button class="btn-secondary" onclick="printInvoice()">üñ®Ô∏è Print</button>
                    <button class="btn-secondary" onclick="emailInvoice()">üìß Email</button>
                </div>
            </section>

            <section id="listScreen" class="screen">
                <div class="screen-title">Invoices</div>
                <div id="invoiceListContainer" style="padding:20px;">Loading...</div>
            </section>

            <section id="menuScreen" class="screen">
                <div class="screen-title">Menu</div>
                <div class="menu-list">
                    <button class="menu-item" onclick="showScreen('invoiceScreen')">üìã New Invoice</button>
                    <button class="menu-item" onclick="showScreen('listScreen'); loadInvoices()">üìÇ View Invoices</button>
                    <button class="menu-item" onclick="logout()">üö™ Logout</button>
                </div>
            </section>
        </main>

        <div id="addCustomerModal" class="modal">
            <div class="modal-content">
                <h2>Add New Customer</h2>
                <input type="text" id="custName" placeholder="Customer Name" autofocus>
                <input type="email" id="custEmail" placeholder="Email">
                <input type="tel" id="custPhone" placeholder="Phone">
                <input type="text" id="custAddress" placeholder="Address">
                <input type="text" id="custTown" placeholder="Town/City">
                <input type="text" id="custCounty" placeholder="County">
                <div style="display:flex;gap:10px;margin-top:20px;">
                    <button class="btn-primary" onclick="saveCustomer()">Save</button>
                    <button class="btn-secondary" onclick="closeModal('addCustomerModal')">Cancel</button>
                </div>
            </div>
        </div>

        <div id="loginModal" class="modal active">
            <div class="modal-content" style="max-width:400px;">
                <h2>Login</h2>
                <input type="text" id="username" placeholder="Username" autofocus>
                <input type="password" id="password" placeholder="Password">
                <button class="btn-primary" onclick="login()" style="margin-top:20px;width:100%;">Sign In</button>
                <p style="text-align:center;margin-top:20px;font-size:12px;color:#666;">Default: admin / Easy2026!</p>
                <div id="loginError" style="color:red;margin-top:10px;display:none;"></div>
            </div>
        </div>
    </div>

    <script src="/ebmpro/js/db.js"></script>
    <script src="/ebmpro/js/api.js"></script>
    <script src="/ebmpro/js/invoice.js"></script>
    <script src="/ebmpro/js/app.js"></script>
</body>
</html>
